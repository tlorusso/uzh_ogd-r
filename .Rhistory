library("xaringanstat", lib.loc="C:/Program Files/R/R-3.5.0/library")
library(kofdata)
?get_dataset
data <- fromJSON(http://www.wahlen.zh.ch/abstimmungen/2016_09_25/viewer_download.php)
data <- fromJSON("http://www.wahlen.zh.ch/abstimmungen/2016_09_25/viewer_download.php")
data <- httr::content("http://www.wahlen.zh.ch/abstimmungen/2016_09_25/viewer_download.php")
data <- jsonlite::fromJSON("http://www.wahlen.zh.ch/abstimmungen/2016_09_25/viewer_download.php")
data %>% map_dfr()
library(tidyverse)
library(purrr)
data %>%
map_dfr()
data %>%
map_dfr(bind_rows)
data2 <-data %>%
map_dfr(bind_rows)
View(data2)
data2 <- c(1:3) %>%
map_dfr(data[[.x]], bind_rows)
data2 <- c(1,3) %>%
map_dfr(bind_rows(data[[.x]]))
data2 <- c(1,3) %>%
map_dfr(bind_rows(data[[.]]))
View(data)
data2 <- data[] %>%
map_dfr(bind_rows())
data2 <- data[] %>%
map_dfr(bind_rows)
View(data2)
View(data)
View(data2)
data2$VORLAGEN
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows)
View(data3)
data %>%
map_dfr(bind_rows(.["VORLAGEN"]))
data %>%
map_dfr(bind_rows(.$VORLAGEN))
View(data3)
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows(.),.id="Gemeinde")
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows(),.id="Gemeinde")
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows)
d_id <- rep(seq_along(data), lengths(data))
```{r}
s_id <- sequence(lengths(data))
t_id <- lengths(unlist(data, rec=FALSE))
data.frame(
d_id  = rep(d_id, t_id),
s_id  = rep(s_id, t_id),
t_id  = sequence(t_id),
token = unlist(data)
)
hello <-data.frame(
d_id  = rep(d_id, t_id),
s_id  = rep(s_id, t_id),
t_id  = sequence(t_id),
token = unlist(data)
)
d_id <- rep(seq_along(data), lengths(data))
s_id <- sequence(lengths(data))
t_id <- lengths(unlist(data, rec=FALSE))
hello <-data.frame(
d_id  = rep(d_id, t_id),
s_id  = rep(s_id, t_id),
t_id  = sequence(t_id),
token = unlist(data)
)
hello <-data.frame(
d_id  = rep(VORLAGE_NAME, t_id),
s_id  = rep(s_id, t_id),
t_id  = sequence(t_id),
token = unlist(data)
)
data %>%
modify_depth(-1,~tibble(token=.x) %>% rowid_to_column("t_id")) %>%
map(~map_dfr(.x,identity,.id = "s_id")) %>%
map_dfr(identity,.id = "d_id")
data %>%
modify_depth(0,~tibble(token=.x) %>% rowid_to_column("t_id")) %>%
map(~map_dfr(.x,identity,.id = "s_id")) %>%
map_dfr(identity,.id = "d_id")
data %>%
map(~map_dfr(.x,identity,.id = "s_id")) %>%
map_dfr(identity,.id = "d_id")
data4<-data %>%
map(~map_dfr(.x,identity,.id = "s_id")) %>%
map_dfr(identity,.id = "d_id")
data4<-data %>%
map_dfr(.x,identity,.id = "s_id") %>%
map_dfr(.x["VORLAGEN"],.id = "d_id")
data4<-data %>%
map_dfr(.x["VORLAGEN"],.id = "d_id")
data4<-data %>%
map_dfr(.["VORLAGEN"],.id = "d_id")
data["VORLAGEN"]
data[1]["VORLAGEN"]
data[[1]]["VORLAGEN"]
data[[1]]["VORLAGEN"]
glimpse(data[[1]]["VORLAGEN"])
data4<- 1:2 %>%
map_dfr(data[[.]]["VORLAGEN"],.id = "d_id")
data4<- 1:2 %>%
map_dfr(data[[1]]["VORLAGEN"],.id = "d_id")
data[[1]]["VORLAGEN"]
data4<- c(1:2) %>%
map_dfr(data[[1]]["VORLAGEN"],.id = "d_id")
data4 <- data %>% map_dfr(bind_rows(map_dfr(.`$VORLAGEN` %>%
data4 <- data %>% map_dfr(bind_rows(map_dfr(.$VORLAGEN %>%
map_dfr(bind_rows))))
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows)
data %>%
set_names(seq_along(data)) %>%
map( ~ set_names(.x, seq_along(.x)) %>%
stack) %>%
bind_rows(.id = 'd_id') %>%
group_by(d_id, s_id = ind) %>%
mutate(t_id = row_number())
data %>%
set_names(seq_along(data)) %>%
map( ~ set_names(.x, seq_along(.x)) %>%
stack) %>%
bind_rows(.id = 'd_id')
library(data.table)
rbindlist(data, fill=TRUE)
hello <-rbindlist(data, fill=TRUE)
hello <-rbindlist(data$VORLAGEN, fill=TRUE)
hello <-rbindlist(data$VORLAGE, fill=TRUE)
hello <-flatten(data)
hello <-unlist(data)
data <- jsonlite::fromJSON("http://www.wahlen.zh.ch/abstimmungen/2016_09_25/viewer_download.php")
data3 <- data$VORLAGEN %>%
map_dfr(bind_rows, set_names)
data <- jsonlite::fromJSON("http://www.wahlen.zh.ch/abstimmungen/2016_09_25/viewer_download.php")
data2 <- data[] %>%
map_dfr(bind_rows)
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows, set_names)
data <- jsonlite::fromJSON("http://www.wahlen.zh.ch/abstimmungen/2016_09_25/viewer_download.php")
data2 <- data[] %>%
map_dfr(bind_rows)
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows, set_names)
data2 <- data %>%
map_dfr(bind_rows)
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows, set_names)
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows)
data3 <- data$VORLAGEN %>%
map_dfr(bind_rows)
data %>% unnest()
data2 <- data %>%
map_dfr() %>%
map_dfr("VORLAGEN")
data2 <- data %>%
map_dfr(bind_rows) %>%
map_dfr("VORLAGEN")
data2 <- data %>%
map_dfr(bind_rows)
data2 %>% map("VORLAGEN")
hello <-data2 %>% map("VORLAGEN")
data2 <- data %>%
map_dfr(bind_rows) %>%
map_dfr(1, bind_rows)
data22 <- data %>%
map_dfr(bind_rows) %>%
map_dfr(1)
data22 <- data %>%
map_dfr(bind_rows) %>%
map_dfr("VORLAGEN")
data22 <- data %>%
map_dfr(bind_rows) %>%
map_dfr(.,"VORLAGEN")
data22 <- data %>%
map_dfr(bind_rows)
data22$NAME
View(data2)
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows)
View(data3)
data3 <- data2$VORLAGEN %>%
map_dfr(bind_rows) %>%
rbind(data2)
data2 <- data %>%
map_dfr(bind_rows)
dodod <-do.call(data,rbind)
dodod <-do.call(rbind,data)
data22 <- data %>%
map_dfr(bind_rows) %>%
map_dfr(extract, "VORLAGEN"))
x <- map_dfr(data, extract, c("VORLAGEN"))
x <- map_dfr(data, `[`, c("VORLAGEN"))
View(x)
x <- map_dfr(data, `[`, c("VORLAGEN","GEBIETE"))
x <- map_dfr(data, `[`, c("VORLAGEN","NAME"))
View(data2)
x <- map_dfr(data2, `[`, c("VORLAGEN","BFS"))
data %>%
mutate(json_list = map(data, flatten_dfc)) %>%
unnest()
data %>%
mutate(json_list = map_dfr(data, flatten_dfc)) %>%
unnest()
View(data2)
View(data3)
Reduce(rbind,data)
hhh <-Reduce(rbind,data)
View(hhh)
hhh %>% map_dfr("VORLAGEN")
hh2<-hhh %>% map_dfr("VORLAGEN")
hhh2 <- hhh %>% map_dfr("VORLAGEN")
hhh %>% map_dfr("VORLAGEN")
unlist(lapply(data,                                 ## for each element in the big list
function(x)
sapply(1:length(x),                   ## for each element in the sublist
function(y)do.call("[[",list(x,y)))))
hello <-unlist(lapply(data[[1]],                                 ## for each element in the big list
function(x)
sapply(1:length(x),                   ## for each element in the sublist
function(y)do.call("[[",list(x,y)))))
hello <-unlist(lapply(data,                                 ## for each element in the big list
function(x)
sapply(1:length(x),                   ## for each element in the sublist
function(y)do.call("[[",list(x,y)))))
data.frame(t(sapply(data,c)))
hello <-data.frame(t(sapply(data,c)))
res1 <- data %>%
#bind the inner datasets and create an id column
map(bind_rows, .id = "id") %>%
#bind the outer datasets and create an EXP column
bind_rows(.id = "VORLAGE")
res1 <- data %>%
#bind the inner datasets and create an id column
map(bind_rows, .id = "id") %>%
#bind the outer datasets and create an EXP column
bind_rows(.id = "VORLAGE") %>%
#reshape to wide format
spread(id, VORLAGEN)
DT::datatable(data)
